<!DOCTYPE html><html lang="zh_cn"><head><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta charset="utf-8"><meta name="description" content=""><meta name="author" content="Mike Chen"><title>理解iOS中的touch事件 | 麦客园</title><link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"><link href="../assets/css/rst.css" rel="stylesheet" type="text/css"><link href="../assets/css/code.css" rel="stylesheet" type="text/css"><link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css"><link href="../assets/css/theme.css" rel="stylesheet" type="text/css"><link href="../assets/css/custom.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]--><link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml"><link rel="icon" href="../favicon.ico" sizes="16x16"><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3760af2f06e2095f83b8b7e7c712b7c5";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script></head><body>
<!-- Menubar -->
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </a>

            <a class="brand" href="../">麦客园</a>
            <!-- Everything you want hidden at 940px or less, place within here -->
            <div class="nav-collapse collapse">
                <ul class="nav"><li><a href="../archive.html">文章归档</a>
            </li><li><a href="../categories/index.html">文章分类</a>
            </li><li><a href="../stories/about.html">关于我们</a>

                </li></ul><ul class="nav pull-right"></ul></div>
        </div>
    </div>
</div>
<!-- End of Menubar -->
<div class="container-fluid" id="container-fluid">
    <!--Body content-->
    <div class="row-fluid">
    <div class="span2"></div>
    <div class="span8">
    
    <div class="postbox">
    
    <h1>理解iOS中的touch事件</h1>

    <hr><small>
        发表于: <time class="published" datetime="2012-03-13T09:22:03">2012-03-13 09:22</time>
        

        
          |  更多相关文章：
            <a class="tag" href="../categories/chrome.html"><span class="badge">chrome</span></a>
            <a class="tag" href="../categories/cha-jian.html"><span class="badge">插件</span></a>
            <a class="tag" href="../categories/xia-zai.html"><span class="badge">下载</span></a>
            <a class="tag" href="../categories/an-zhuang.html"><span class="badge">安装</span></a>

    </small>
    <hr><p>touch事件是iOS中最重要的事件。</p>
<h3>一、简介</h3>
<p>Apple的官方文档<a href="http://17.254.2.129/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html">Handling Events</a>和 <a href="http://developer.apple.com/library/safari/#documentation/InternetWeb/Conceptual/SafariVisualEffectsProgGuide/Introduction/Introduction.html">Safari CSS Visual Effects Guide</a>是很好的开发指南，但是里面的内容显然是针对初学者的，我在这里补充一下。</p>
<p>另外，Apple开发者中心有很多不错的HTML5教程与资源，例如HTML5离线存储，CSS动画，CSS 3D变换等，有兴趣的可以了解一下。 <a href="http://developer.apple.com/library/safari/navigation/">http://developer.apple.com/library/safari/navigation/</a></p>
<!-- TEASER_END -->

<h3>二、监听touch事件</h3>
<p>最简单的办法就是，使用<code>element.addEventListener(touchevent,handler,usercapture)</code>来捕捉事件。touch事件的类型有<code>touchstart</code> , <code>touchmove</code> , <code>touchend</code> , <code>touchcancel</code>。在实际使用中，如果你比较习惯模块式开发，你可以使用如下方式捕捉事件，显得更"优雅"。</p>
<h3>三、touch事件的属性</h3>
<p>touch事件的重要属性有以下几个:</p>
<ul><li><code>clientX</code>:X轴坐标，相对于viewport，除去滚动。</li>
<li><code>clientY</code>:轴坐标，相对于viewport，除去滚动。</li>
<li><code>screenX</code>:X轴坐标，相对于显示器屏幕。</li>
<li><code>screenY</code>:Y轴坐标，相对于显示器屏幕。</li>
<li><code>pageX</code>:X轴坐标，相对于HTML文档，包括滚动。</li>
<li><code>pageY</code>:Y轴坐标，相对于HTML文档，包括滚动。</li>
<li><code>target</code>:导致此事件发生的元素。</li>
<li><code>identifier</code>:事件的唯一内部ID。</li>
</ul><h3>四、多点触摸的奥秘</h3>
<p>本文的重点在于此，虽然iOS中提供了<code>gesture event</code>，但是如果我们需要定制自己的手势，还要深入进行研究。touchevent有如下三个属性，记录了从手指接触屏幕，到离开屏幕的全部过程。</p>
<ul><li><code>e.touches</code>:保存你每一个手指落到屏幕上导致的touch事件的信息。</li>
<li><code>e.targetTouches</code>:只保存手指落到同一个元素上导致的touch事件的信息。</li>
<li><code>e.changedTouches</code>:保存导致touch事件发生改变的touch事件信息</li>
</ul><h3>五、实例操作</h3>
<p>看到这里你可能完全迷糊了，没关系，亲手体验一下下面的例子就明白这三个属性是如何协同工作的了，如果你使用iOS系统，可以使用手指操作下面的白色区域，仔细观察一下，就明白了。</p>
<div id="toucheventsample" style="position:relative;width:100%;height:400px;background:white;border:1px solid #CCC;">
<div id="tracer" style="font-family:Helvetica;font-size:12px;position:absolute;top:15px;left:15px;color:red;"></div>
</div>

<script type="text/javascript">
        (function(){

            var uid = 0;

            function imageViewer( el ){
                var self = this;
                this.uid = ++uid;

                this.scale = 1.0;
                this.rotation = 0;
                this.element = el;
                this.wrapper = this.element.parentNode;
                this.element.addEventListener("touchstart",this,false);
                this.element.addEventListener("touchmove",this,false);
                this.element.addEventListener("touchend",this,false);
            }

            function toStr( e ){
                var s = '';
                for( var i=0,l=e.touches.length;i<l;i++ ){
                    s = s + "e.touches["+i+"](clientX,clientY)"+"("+e.touches[i].clientX+","+e.touches[i].clientY+")";
                    s = s + "<br/>";
                }
                s += "<hr/>"
                for( var i=0,l=e.targetTouches.length;i<l;i++ ){
                    s = s + "e.targetTouches["+i+"](clientX,clientY)"+"("+e.targetTouches[i].clientX+","+e.targetTouches[i].clientY+")";
                    s = s + "<br/>";
                }
                s += "<hr/>"
                for( var i=0,l=e.changedTouches.length;i<l;i++ ){
                    s = s + "e.changedTouches["+i+"](clientX,clientY)"+"("+e.changedTouches[i].clientX+","+e.changedTouches[i].clientY+")";
                    s = s + "<br/>";
                }
                return s;
            }
            function trace( e ){
                document.getElementById("tracer").innerHTML = "<b>"+e.type+"</b><hr/>"+toStr(e);
            }

            imageViewer.prototype = {
                handleEvent : function(e){
                    switch(e.type){
                        case "touchstart":
                            e.preventDefault();
                            trace(e);
                        break;
                        case "touchmove":
                            trace(e);
                        break;
                        case "touchend":
                            trace(e);
                        break;
                    }
                }
            }

            new imageViewer(document.getElementById('toucheventsample'));
        })();

        </script><ul class="pager"><li class="previous">
            <a href="how-to-download-chrome-plugin-and-setup-offline.html">← 前一篇</a>
        </li>
        <li class="next">
            <a href="hello-rst.html">后一篇 →</a>
        </li>
    </ul><hr><div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare">
  <a class="bds_tsina"></a>
  <a class="bds_qzone"></a>
  <a class="bds_tqq"></a>
  <a class="bds_renren"></a>
  <a class="bds_t163"></a>
  <a class="bds_tqf"></a>
  <a class="bds_douban"></a>
  <a class="bds_kaixin001"></a>
  <a class="bds_sqq"></a>
  <a class="bds_fbook"></a>
  <a class="bds_twi"></a>
  <a class="bds_mshare"></a>
  <span class="bds_more"></span>
  </div>
  <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=6739020"></script><script type="text/javascript" id="bdshell_js"></script><script type="text/javascript">
  document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
  </script><div class="ds-thread" data-category="cache\posts\how-mobile-safari-touch-event-works.html" data-thread-key="" data-title="理解iOS中的touch事件" data-author-key="" data-url="http://mikecyc.github.io/posts/how-mobile-safari-touch-event-works.html"></div>
      <script type="text/javascript">
      var duoshuoQuery = {short_name:"mikecyc"};
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = 'http://static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0] 
          || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
        </script></div>

    </div>
    </div>
    <!--End of body content-->
</div>
<div class="footerbox">
    Contents © <a href="mailto:mike.cyc@gmail.com">Mike Chen</a> - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
</div>



            <script src="../assets/js/jquery-1.7.2.min.js" type="text/javascript"></script><script src="../assets/js/bootstrap.min.js" type="text/javascript"></script><script src="../assets/js/jquery.colorbox-min.js" type="text/javascript"></script><script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?type=slide&amp;fade=1"></script><a href="http://www.ujian.cc" style="border:0;"><img src="http://img.ujian.cc/pixel.png" alt="友荐云推荐" style="border:0;padding:0;margin:0;"></a>


    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"80%",maxHeight:"80%",scalePhotos:true});</script></body></html>